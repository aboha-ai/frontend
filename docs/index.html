<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ì¶”ì²œ ì—¬í–‰ì§€</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
      rel="stylesheet"
    />
    <link
      href="https://ai-public.creatie.ai/gen_page/tailwind-custom.css"
      rel="stylesheet"
    />
    <!-- Axios ë¼ì´ë¸ŒëŸ¬ë¦¬ í¬í•¨ -->
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- ë¨¼ì € googleMap.jsë¥¼ ë¡œë“œ (ëª¨ë“ˆë¡œ ë¡œë“œ) -->
    <!-- <script type="module" src="assets/js/googleMap.js"></script> -->

    <script
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAb8P-xJKQkXwIMeA-MakTSMisMhDhcuNY&callback=initMap&libraries=places"
      async
      defer
    ></script>
  </head>

  <body class="font-sans bg-gray-50">
    <header
      class="h-[60px] px-4 flex items-center justify-between border-b border-gray-200"
    >
      <button class="text-2xl"><i class="fas fa-bars"></i></button>
      <div class="text-2xl font-bold">go</div>
      <img
        src="https://creatie.ai/ai/api/search-image?query=A professional headshot of a person&width=40&height=40"
        class="w-10 h-10 rounded-full object-cover"
      />
    </header>

    <nav class="flex border-b border-gray-200">
      <button
        id="ë§›ì§‘-tab"
        class="tab-button px-6 py-3 text-gray-600"
        onclick="changeTab('ë§›ì§‘')"
      >
        ë§›ì§‘
      </button>
      <button
        id="ê´€ê´‘ì§€-tab"
        class="tab-button px-6 py-3 bg-black text-white"
        onclick="changeTab('ê´€ê´‘ì§€')"
      >
        ê´€ê´‘ì§€
      </button>
      <button
        id="í˜¸í…”-tab"
        class="tab-button px-6 py-3 text-gray-600"
        onclick="changeTab('í˜¸í…”')"
      >
        í˜¸í…”
      </button>
    </nav>

    <main class="flex relative">
      <div
        class="w-full sm:w-[30%] border-r border-gray-200 h-[calc(100vh-180px)] overflow-y-auto"
      >
        <div
          id="ë§›ì§‘-content"
          class="content-section p-4 border-b border-gray-200"
        ></div>
        <div
          id="ê´€ê´‘ì§€-content"
          class="content-section p-4 border-b border-gray-200"
        ></div>
        <div
          id="í˜¸í…”-content"
          class="content-section p-4 border-b border-gray-200"
        ></div>
      </div>

      <!-- âœ… Google Maps ì˜ì—­ -->
      <div
        id="map"
        class="w-full sm:w-[70%] h-[calc(100vh-60px)] top-0 left-0 z-10"
      ></div>

      <div class="w-full sm:w-[30%] p-4">
        <h3 class="text-xl font-bold mb-4" id="place-name">ê´€ê´‘ì§€ ì„¤ëª…</h3>
        <img
          id="place-photo"
          class="w-full h-60 object-cover mb-4 rounded-md"
        />
        <p id="place-hours" class="text-sm text-gray-600"></p>
        <p id="place-price" class="text-sm text-gray-600"></p>
        <p id="place-description" class="text-sm text-gray-600"></p>
      </div>
    </main>

    <footer class="bg-white mt-12">
      <div class="max-w-8xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <div class="text-center text-gray-500 text-sm">
          Â© 2025 ì•„ë³´í•˜ ì—¬í–‰. All rights reserved.
        </div>
      </div>
    </footer>

    <!-- íŒì—…ì„ ìœ„í•œ div -->
    <div id="modal" class="modal hidden">
      <div class="modal-content">
        <span id="close-btn" class="close-btn">&times;</span>
        <h2 id="popup-title"></h2>
        <p id="popup-description"></p>
      </div>
    </div>

    <!-- ìƒˆë¡œ ì¶”ì²œë°›ê¸° ë²„íŠ¼ -->
    <button
      id="refresh-btn"
      class="fixed bottom-4 right-4 bg-black text-white px-4 py-2 rounded-full shadow-lg"
    >
      ğŸ”„ ì¶”ì²œ ë‹¤ì‹œ ë°›ê¸°
    </button>
  </body>
  <script src="assets/js/googleMap.js"></script>
  <script src="assets/js/api.js"></script>
  <script src="assets/js/tabHandler.js"></script>
  <script>
    let map;

    // Google Map ì´ˆê¸°í™”
    function initMap() {
      map = new google.maps.Map(document.getElementById("map"), {
        center: { lat: 37.5665, lng: 126.978 }, // ì„œìš¸ ì¢Œí‘œ
        zoom: 12,
      });
    }

    // ë§ˆì»¤ë¥¼ í´ë¦­í–ˆì„ ë•Œ ì¥ì†Œ ì •ë³´ë¥¼ í‘œì‹œ
    window.showLocation = function (location, name) {
      if (!map) {
        console.error("âŒ Google Map is not initialized!");
        return;
      }

      // ê¸°ì¡´ ë§ˆì»¤ ì œê±°
      const marker = new google.maps.Marker({
        position: location,
        map: map,
        animation: google.maps.Animation.DROP,
        title: name || "ì´ ì¥ì†Œ", // ë§ˆì»¤ì— í‘œì‹œë  ì œëª©
      });

      // ì§€ë„ ì¤‘ì•™ì„ í´ë¦­í•œ ì¥ì†Œë¡œ ì´ë™
      map.setCenter(location);
      map.setZoom(14);

      // êµ¬ê¸€ ì¥ì†Œ ê²€ìƒ‰ ì„œë¹„ìŠ¤
      const service = new google.maps.places.PlacesService(map);
      const request = {
        location: location,
        radius: 500, // ë°˜ê²½ 500m ì´ë‚´ì—ì„œ ê²€ìƒ‰
        query: name, // ì¥ì†Œ ì´ë¦„ì„ ê¸°ì¤€ìœ¼ë¡œ ê²€ìƒ‰
      };

      // ì¥ì†Œ ê²€ìƒ‰
      service.textSearch(request, function (results, status) {
        if (status === google.maps.places.PlacesServiceStatus.OK) {
          // ê²€ìƒ‰ ê²°ê³¼ë¡œ ì²« ë²ˆì§¸ ì¥ì†Œ í‘œì‹œ
          const result = results[0];
          const infoWindow = new google.maps.InfoWindow({
            content: `<div><strong>${result.name}</strong><br>${result.formatted_address}</div>`,
          });

          // ë§ˆì»¤ í´ë¦­ ì‹œ ì •ë³´ ì°½ì„ í‘œì‹œí•˜ë„ë¡ ì„¤ì •
          marker.addListener("click", function () {
            infoWindow.open(map, marker);
          });
        } else {
          console.error("âŒ êµ¬ê¸€ ì¥ì†Œ ê²€ìƒ‰ ì‹¤íŒ¨:", status);
        }
      });
    };
  </script>
</html>
